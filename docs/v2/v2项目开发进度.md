# v2 项目开发进度

## 📊 整体进度概览

**最后更新**：2026-01-21  
**当前阶段**：Phase 3 L2 + Mode + AI（Claims闭环已完成，AI未开始；Phase 2 UI待实现）  
**实施细则完成度**：47/47 (100%)  
**开发实现完成度**：21/47 (45%)

### 阶段完成情况（以“开发实现”计）

- [x] 阶段1：Phase 0 契约基线 + 红线固化 (4/4)
- [x] 阶段2：Phase 1 后端数据产品最小可用 (11/11)
- [ ] 阶段3：Phase 2 前端联动闭环 (2/14)
- [ ] 阶段4：Phase 3 L2 + Mode + AI 闭环 (4/12)
- [ ] 阶段5：Phase 4 合规 + 观测 + 优化 (0/6)

> 说明：本进度文档用于跟踪“代码实现/联调/验收”。实施细则已全部完成，详见 `docs/v2/v2实施细则/`。

---

## 📋 详细进度跟踪

### 阶段1：Phase 0 契约基线 + 红线固化
**目标**：固化跨端契约，使 FE/BE 可并行独立开发

| 步骤 | 步骤名称 | 状态 | 开始日期 | 完成日期 | 验收日期 | 备注 |
|------|---------|------|---------|---------|---------|------|
| 01 | Shared Contract 基线（维度/DTO/口径） | ✔️ 已验收 | 2026-01-20 | 2026-01-20 | 2026-01-21 | 实施细则：`docs/v2/v2实施细则/01-Shared-Contract基线-细则.md` |
| 02 | Access Mode 裁剪基线（后端输出裁剪规则） | ✔️ 已验收 | 2026-01-20 | 2026-01-20 | 2026-01-21 | 实施细则：`docs/v2/v2实施细则/02-Access-Mode裁剪基线-细则.md` |
| 03 | Prediction Run 基线（active_run / run_id 传播） | ✔️ 已验收 | 2026-01-20 | 2026-01-20 | 2026-01-21 | 实施细则：`docs/v2/v2实施细则/03-Prediction-Run基线-细则.md` |
| 04 | 时间与时区口径统一 | ✔️ 已验收 | 2026-01-20 | 2026-01-20 | 2026-01-21 | 实施细则：`docs/v2/v2实施细则/04-时间与时区口径统一-细则.md` |

**阶段状态**：✅ 已完成

---

### 阶段2：Phase 1 后端数据产品最小可用
**目标**：L0/L1/Overlays API 可调用；predicted 批次一致性可验证

> Phase 1/2 临时策略（强制）：claims 事实域在 Phase 3（Step 30/31/32）。Phase 1/2 中所有 claims 相关内容必须为 disabled/placeholder，并显式 `claims_available=false`（字段名以 Shared Contract 为准）；禁止伪造 claims 事实。

| 步骤 | 步骤名称 | 状态 | 开始日期 | 完成日期 | 验收日期 | 备注 |
|------|---------|------|---------|---------|---------|------|
| 05 | 产品表 + Product Service | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/05-产品表与Product-Service-细则.md` |
| 06 | 保单表 + Policy Service | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/06-保单表与Policy-Service-细则.md` |
| 07 | 天气数据表 + Weather Service | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/07-天气数据表与Weather-Service-细则.md` |
| 08 | Risk Calculator（计算内核） | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/08-Risk-Calculator计算内核-细则.md` |
| 09 | 风险事件表 + Risk Service | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/09-风险事件表与Risk-Service-细则.md` |
| 10 | 预测批次表 + Prediction Run Service | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/10-预测批次表与Prediction-Run-Service-细则.md` |
| 11 | L0 Dashboard Data Product | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/11-L0-Dashboard数据产品-细则.md`；Phase 1/2 Claims placeholder |
| 12 | Map Overlays Data Product | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/12-Map-Overlays数据产品-细则.md` |
| 13 | L1 Region Intelligence Data Product | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/13-L1-Region-Intelligence数据产品-细则.md`；Phase 1/2 Claims placeholder |
| 14 | Celery 任务基础设施 | ✅ 已完成 | 2026-01-21 | 2026-01-21 | - | 实施细则：`docs/v2/v2实施细则/14-Celery任务基础设施-细则.md` |
| 15 | 风险事件计算任务 | ✅ 已完成 | 2026-01-21 | 2026-01-21 | - | 实施细则：`docs/v2/v2实施细则/15-风险事件计算任务-细则.md` |

**阶段状态**：✅ 已完成

---

### 阶段3：Phase 2 前端联动闭环
**目标**：Map + L0 + 锁区 + L1 Timeline 可交互（hover 0 重请求）

> Phase 2 临时策略（强制）：Claims 仍为 disabled/placeholder；UI 必须“可见但不可用 + 解释清晰”，不得触发 claims 请求；AI 不得输出 claims 结论/CTA。

| 步骤 | 步骤名称 | 状态 | 开始日期 | 完成日期 | 验收日期 | 备注 |
|------|---------|------|---------|---------|---------|------|
| 16 | 项目结构与类型定义（Vite） | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/16-前端项目结构与类型定义-细则.md` |
| 17 | Google Maps API 配置与初始化 | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/17-Google-Maps-API配置与初始化-细则.md` |
| 18 | Map Stage 基线（加载/交互/图层框架） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/18-Map-Stage基线-细则.md` |
| 19 | 行政区域边界渲染与选区交互 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/19-行政区域边界渲染与选区交互-细则.md` |
| 20 | UI Orchestration（状态机 + 联动矩阵） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/20-UI-Orchestration状态机与联动矩阵-细则.md` |
| 21 | L0 Sidebar（省级态势抽屉） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/21-L0-Sidebar省级态势抽屉-细则.md`；Phase 2 Claims tab disabled |
| 22 | 天气热力图图层 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/22-天气热力图图层-细则.md` |
| 23 | 风险事件标记图层 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/23-风险事件标记图层-细则.md` |
| 24 | 控制面板（Top Bar） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/24-控制面板Top-Bar-细则.md` |
| 25 | 产品选择器 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/25-产品选择器Product-Selector-细则.md` |
| 26 | Region Intelligence Panel 基础结构 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/26-Region-Intelligence-Panel基础结构-细则.md` |
| 27 | 统一时间轴（三泳道对齐） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/27-统一时间轴三泳道对齐-细则.md`；Phase 2 Claims lane placeholder |
| 28 | 图表可视化（Weather/Risk/Claims） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/28-图表可视化-细则.md`；Phase 2 Claims chart placeholder |
| 29 | GPS 定位与反向地理编码 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/29-GPS定位与反向地理编码-细则.md` |

**阶段状态**：⏭️ 基础完成

---

### 阶段4：Phase 3 L2 + Mode + AI 闭环
**目标**：claims 域落地 + L2 证据链 + AI 导演式联动（全链路 Mode-aware）

| 步骤 | 步骤名称 | 状态 | 开始日期 | 完成日期 | 验收日期 | 备注 |
|------|---------|------|---------|---------|---------|------|
| 30 | 理赔表 + Claim Service | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/30-理赔表与Claim-Service-细则.md` |
| 31 | Claim Calculator（Tier 差额逻辑） | ✅ 已完成 | 2026-01-20 | 2026-01-20 | - | 实施细则：`docs/v2/v2实施细则/31-Claim-Calculator计算内核-细则.md` |
| 32 | 理赔计算任务 | ✅ 已完成 | 2026-01-21 | 2026-01-21 | - | 实施细则：`docs/v2/v2实施细则/32-理赔计算任务-细则.md` |
| 33 | L2 Evidence Data Product | ✅ 已完成 | 2026-01-21 | 2026-01-21 | - | 实施细则：`docs/v2/v2实施细则/33-L2-Evidence数据产品-细则.md` |
| 34 | Claims Overlay | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/34-Claims-Overlay图层-细则.md`；predicted 下禁用 |
| 35 | L2 Details 面板 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/35-L2-Details面板-细则.md` |
| 36 | 分析汇总卡片（Overview） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/36-分析汇总卡片-细则.md`；Phase 2 claims KPI disabled 已定义 |
| 37 | Router Agent（NLU + 路由 + 格式化） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/37-Router-Agent-细则.md` |
| 38 | Expertise Agents（Product/Risk/Policy） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/38-Expertise-Agents-细则.md` |
| 39 | AI Insight Cards | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/39-AI-Insight-Cards-细则.md`；必须检查 claims_available |
| 40 | AI CTA → Orchestration 联动 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/40-AI-CTA到Orchestration联动-细则.md` |
| 41 | AI 聊天窗（保留入口） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/41-AI聊天窗（保留入口）-细则.md`；claims 不可用时禁止推断 |

**阶段状态**：🚧 进行中

---

### 阶段5：Phase 4 合规 + 观测 + 优化
**目标**：生产就绪（合规 gate + 可观测闭环 + 性能/降级 + E2E 验收）

| 步骤 | 步骤名称 | 状态 | 开始日期 | 完成日期 | 验收日期 | 备注 |
|------|---------|------|---------|---------|---------|------|
| 42 | Google Maps 合规 Gate 落地 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/42-Google-Maps-合规Gate落地-细则.md` |
| 43 | 可观测性基础设施 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/43-可观测性基础设施-细则.md` |
| 44 | Mode 默认值/审计/回滚 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/44-Mode默认值与审计回滚-细则.md` |
| 45 | 性能优化（缓存/预聚合/节流） | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/45-性能优化与压测门槛-细则.md` |
| 46 | 移动端/低性能降级 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/46-移动端与低性能降级策略-细则.md` |
| 47 | 端到端测试与验收 | ⏳ 待开始 | - | - | - | 实施细则：`docs/v2/v2实施细则/47-端到端测试与验收-细则.md` |

**阶段状态**：⏳ 待开始

---

## 📝 状态说明

### 状态标记
- ⏳ **待开始**：尚未开始开发
- 🔄 **进行中**：正在开发中
- ✅ **已完成**：开发完成，待验收
- ✔️ **已验收**：已完成并通过验收
- ⚠️ **有问题**：开发过程中遇到问题，需要解决
- 🔒 **已阻塞**：因依赖未完成或其他原因被阻塞

### 更新说明
- **开始日期**：开始开发该步骤的日期
- **完成日期**：完成开发（代码合并）的日期
- **验收日期**：通过验收测试的日期（建议对应 Step 47 的验收项）
- **备注**：记录关键信息、问题、注意事项、相关 PR/Issue 链接等

---

## 🚨 当前问题与风险

### 待解决问题
- Phase 3 新增测试未执行（claims / claim_calculator / l2_evidence）
- 数据库与Redis未配置导致集成测试阻塞
- Phase 2 UI设计未确认，导致 18-29 无法开工

### 风险提示（建议持续更新）
- **Phase 1/2 claims 不可用的误导风险**：已通过 `claims_available=false` + UI/AI placeholder/禁用策略在步骤总览与实施细则中固化；执行阶段需严禁“前端补齐/伪造 claims”。
- **Maps 成本与 Key 风险**：Phase 4 必须先打通合规 Gate（Step 42）再开放公开 Demo。
- **交互风暴风险**：hover 0 重请求/brush commit 才刷新是硬门槛（Step 20/45/47）。
- **测试滞后风险**：Phase 3 后端新增测试未运行，验收口径需明确“未执行”。

---

## 📈 里程碑记录

### 已完成里程碑
- [x] **里程碑0**：完成 Phase 0–4 全量实施细则（47/47）— 2026-01-19
- [x] **里程碑1**：完成 Phase 0 契约基线（4/4）— 2026-01-20
- [x] **里程碑2**：完成 Phase 1 后端数据产品最小可用（11/11）— 2026-01-21

### 计划里程碑（建议在执行期补充预计日期）
- [ ] **里程碑3**：完成阶段3（Phase 2 前端联动闭环）- 预计完成日期：待定
- [ ] **里程碑4**：完成阶段4（Phase 3 claims + L2 + AI 闭环）- 预计完成日期：待定
- [ ] **里程碑5**：完成阶段5（Phase 4 合规/观测/优化 + E2E 验收）- 预计完成日期：待定
- [ ] **最终里程碑**：项目完成，所有功能验收通过 - 预计完成日期：待定

---

## 📚 相关文档

- **v2 项目总览**：`docs/v2/v2项目总览.md`
- **v2 实现步骤总览**：`docs/v2/v2实现步骤总览.md`
- **v2 文档治理与实施拆解方针**：`docs/v2/v2文档治理与实施拆解方针.md`
- **v2 实施细则目录**：`docs/v2/v2实施细则/`
- **v2 复用逻辑摘录索引**：`docs/v2/v2复用逻辑摘录/README.md`

---

**文档版本**：v2.0  
**创建日期**：2026-01-19  
**最后更新**：2026-01-19

